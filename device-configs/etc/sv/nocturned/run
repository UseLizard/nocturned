#!/bin/sh

exec 2>&1
sv check dbus > /dev/null || exit 1
sv check bluetoothd > /dev/null || exit 1  
sv check bluetooth_adapter > /dev/null || exit 1

# Give Bluetooth hardware extra time to fully initialize after btattach
sleep 5

# Wait for Bluetooth adapter to be fully ready
for i in 1 2 3 4 5; do
    if bluetoothctl show > /dev/null 2>&1; then
        break
    fi
    sleep 2
done

exec /usr/local/bin/nocturned > /dev/null 2>&1
